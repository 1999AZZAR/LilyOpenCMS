{% extends 'admin_base.html' %}
{% block title %}Manajemen Pengguna - Admin{% endblock %}
{% block hero_title %}Manajemen Pengguna{% endblock %}
{% block hero_desc %}Kelola pengguna, peran, dan hak akses mereka{% endblock %}
{% block content %}
<div id="toast-container" class="fixed top-5 right-5 space-y-2 z-50" role="status" aria-live="polite"></div>

<!-- Navigation Tabs -->
<div class="mb-6">
  <nav class="flex space-x-1 bg-amber-100 p-1 rounded-lg" role="tablist">
    <button class="tab-button active bg-white text-amber-800 px-4 py-2 rounded-md font-medium" data-tab="users">
      <i class="fas fa-users mr-2"></i>Semua Pengguna
    </button>
    <button class="tab-button bg-amber-200 text-amber-700 px-4 py-2 rounded-md font-medium" data-tab="roles">
      <i class="fas fa-user-tag mr-2"></i>Peran & Izin
    </button>
    <button class="tab-button bg-amber-200 text-amber-700 px-4 py-2 rounded-md font-medium" data-tab="pending">
      <i class="fas fa-clock mr-2"></i>Menunggu Persetujuan
    </button>
    <button class="tab-button bg-amber-200 text-amber-700 px-4 py-2 rounded-md font-medium" data-tab="performance">
      <i class="fas fa-chart-line mr-2"></i>Performa Pengguna
    </button>
  </nav>
</div>

<!-- Users Tab -->
<div id="users-tab" class="tab-content active">
  <main class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-lg mb-8" role="main">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-xl font-semibold text-amber-800">Semua Pengguna</h2>
      <div class="flex space-x-2">
        <button id="bulk-actions-btn" class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-lg font-medium hidden">
          <i class="fas fa-tasks mr-2"></i>Aksi Massal
        </button>
        <button id="export-users-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-download mr-2"></i>Ekspor
        </button>
      </div>
    </div>

    <!-- Bulk Actions Panel -->
    <div id="bulk-actions-panel" class="bg-white border border-amber-200 rounded-lg p-4 mb-4 hidden">
      <h3 class="text-lg font-semibold text-amber-800 mb-3">Aksi Massal</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <button id="bulk-activate" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded text-sm">
          <i class="fas fa-check mr-1"></i>Aktifkan
        </button>
        <button id="bulk-deactivate" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded text-sm">
          <i class="fas fa-pause mr-1"></i>Nonaktifkan
        </button>
        <button id="bulk-verify" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
          <i class="fas fa-check-circle mr-1"></i>Verifikasi
        </button>
        <button id="bulk-suspend" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm">
          <i class="fas fa-ban mr-1"></i>Suspend
        </button>
      </div>
      <div class="mt-3 text-sm text-amber-600">
        <span id="selected-count">0</span> pengguna dipilih
      </div>
    </div>

    <div class="mb-6 flex flex-wrap gap-4" role="search" aria-label="Filter dan pencarian pengguna">
      <div class="flex-1">
        <label for="search" class="sr-only">Cari pengguna</label>
        <input type="text" id="search" placeholder="Cari berdasarkan nama pengguna, email..." class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" aria-label="Cari berdasarkan nama pengguna">
      </div>
      <div>
        <label for="role-filter" class="sr-only">Filter berdasarkan peran</label>
        <select id="role-filter" class="w-48 bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" aria-label="Filter berdasarkan peran pengguna">
          <option value="">Semua Peran</option>
          <option value="su">Superuser</option>
          <option value="admin">Admin</option>
          <option value="general">Umum</option>
        </select>
      </div>
      <div>
        <label for="status-filter" class="sr-only">Filter berdasarkan status</label>
        <select id="status-filter" class="w-48 bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" aria-label="Filter berdasarkan status pengguna">
          <option value="">Semua Status</option>
          <option value="active">Aktif</option>
          <option value="inactive">Tidak Aktif</option>
          <option value="suspended">Tersuspend</option>
        </select>
      </div>
      <div>
        <label for="verification-filter" class="sr-only">Filter berdasarkan status verifikasi</label>
        <select id="verification-filter" class="w-48 bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" aria-label="Filter berdasarkan status verifikasi pengguna">
          <option value="">Semua Status Verifikasi</option>
          <option value="verified">Terverifikasi</option>
          <option value="unverified">Belum Terverifikasi</option>
        </select>
      </div>
    </div>

    <div class="space-y-8">
      <section aria-labelledby="admin-users-title">
        <h3 id="admin-users-title" class="text-xl font-bold text-amber-600 mb-4">Pengguna Admin</h3>
        <div id="admin-users" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" role="list" aria-label="Daftar pengguna admin">
          <div class="col-span-full text-amber-600" role="status">Memuat pengguna admin...</div>
        </div>
      </section>
      <section aria-labelledby="general-users-title">
        <h3 id="general-users-title" class="text-xl font-bold text-amber-600 mb-4">Pengguna Umum</h3>
        <div id="general-users" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" role="list" aria-label="Daftar pengguna umum">
          <div class="col-span-full text-amber-600" role="status">Memuat pengguna umum...</div>
        </div>
      </section>
    </div>
  </main>
</div>

<!-- Roles Tab -->
<div id="roles-tab" class="tab-content hidden">
  <main class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-lg mb-8" role="main">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-xl font-semibold text-amber-800">Peran & Izin</h2>
      <div class="flex space-x-2">
        <button id="export-roles-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-download mr-2"></i>Ekspor
        </button>
        <button id="create-role-btn" onclick="openCreateRoleModal()" class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-plus mr-2"></i>Buat Peran Baru
        </button>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Custom Roles -->
      <div>
        <h3 class="text-lg font-semibold text-amber-700 mb-4">Peran Kustom</h3>
        <div id="custom-roles" class="space-y-3">
          <div class="text-amber-600">Memuat peran...</div>
        </div>
      </div>

      <!-- Permissions -->
      <div>
        <h3 class="text-lg font-semibold text-amber-700 mb-4">Izin Sistem</h3>
        <div id="permissions" class="space-y-3">
          <div class="text-amber-600">Memuat izin...</div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Pending Approvals Tab -->
<div id="pending-tab" class="tab-content hidden">
  <main class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-lg mb-8" role="main">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-xl font-semibold text-amber-800">Menunggu Persetujuan</h2>
      <div class="flex space-x-2">
        <button id="bulk-approve-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-check mr-2"></i>Setujui Semua
        </button>
        <button id="bulk-reject-btn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-times mr-2"></i>Tolak Semua
        </button>
      </div>
    </div>

    <div id="pending-users" class="space-y-4">
      <div class="text-amber-600">Memuat pengguna yang menunggu persetujuan...</div>
    </div>
  </main>
</div>

<!-- Performance Tab -->
<div id="performance-tab" class="tab-content hidden">
  <main class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-lg mb-8" role="main">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-xl font-semibold text-amber-800">Performa Pengguna</h2>
      <div class="flex space-x-2">
        <select id="performance-period" class="bg-white border border-amber-300 text-amber-700 p-2 rounded-lg">
          <option value="7">7 Hari Terakhir</option>
          <option value="30" selected>30 Hari Terakhir</option>
          <option value="90">90 Hari Terakhir</option>
        </select>
        <button id="export-performance-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
          <i class="fas fa-download mr-2"></i>Ekspor Laporan
        </button>
      </div>
    </div>

    <!-- Performance Summary -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-white p-4 rounded-lg border border-amber-200">
        <h3 class="text-sm font-medium text-amber-600">Total Pengguna Aktif</h3>
        <p id="active-users-count" class="text-2xl font-bold text-amber-800">-</p>
      </div>
      <div class="bg-white p-4 rounded-lg border border-amber-200">
        <h3 class="text-sm font-medium text-amber-600">Total Aktivitas</h3>
        <p id="total-activities" class="text-2xl font-bold text-amber-800">-</p>
      </div>
      <div class="bg-white p-4 rounded-lg border border-amber-200">
        <h3 class="text-sm font-medium text-amber-600">Konten Dibuat</h3>
        <p id="total-content" class="text-2xl font-bold text-amber-800">-</p>
      </div>
      <div class="bg-white p-4 rounded-lg border border-amber-200">
        <h3 class="text-sm font-medium text-amber-600">Skor Engagement</h3>
        <p id="avg-engagement" class="text-2xl font-bold text-amber-800">-</p>
      </div>
    </div>

    <!-- Performance Leaderboard -->
    <div>
      <h3 class="text-lg font-semibold text-amber-700 mb-4">Papan Skor Performa</h3>
      <div id="performance-leaderboard" class="space-y-3">
        <div class="text-amber-600">Memuat papan skor...</div>
      </div>
    </div>
  </main>
</div>

<!-- Enhanced Edit User Modal -->
<div id="edit-user-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50" role="dialog" aria-labelledby="edit-user-title" aria-modal="true">
    <div class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <h2 id="edit-user-title" class="text-xl font-semibold mb-6 text-amber-800">Edit Pengguna</h2>
        <form id="edit-user-form" class="space-y-6" role="form" aria-label="Form edit pengguna">
            <input type="hidden" id="edit-user-id">
            
            <!-- Basic Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="edit-username" class="block text-amber-700 font-medium mb-2">Nama Pengguna</label>
                    <input type="text" id="edit-username" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" required aria-required="true">
                </div>
                <div>
                    <label for="edit-email" class="block text-amber-700 font-medium mb-2">Email (Opsional)</label>
                    <input type="email" id="edit-email" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" title="Masukkan alamat email yang valid atau biarkan kosong">
                </div>
                <div>
                    <label for="edit-first-name" class="block text-amber-700 font-medium mb-2">Nama Depan</label>
                    <input type="text" id="edit-first-name" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                </div>
                <div>
                    <label for="edit-last-name" class="block text-amber-700 font-medium mb-2">Nama Belakang</label>
                    <input type="text" id="edit-last-name" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                </div>
            </div>

            <div>
                <label for="edit-bio" class="block text-amber-700 font-medium mb-2">Bio</label>
                <textarea id="edit-bio" rows="3" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400"></textarea>
            </div>

            <!-- Role and Status -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="edit-role" class="block text-amber-700 font-medium mb-2">Peran Sistem</label>
                    <select id="edit-role" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" aria-label="Pilih peran pengguna">
                        <option value="su">Superuser</option>
                        <option value="admin">Admin</option>
                        <option value="general">Umum</option>
                    </select>
                </div>
                <div>
                    <label for="edit-custom-role" class="block text-amber-700 font-medium mb-2">Peran Kustom</label>
                    <select id="edit-custom-role" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                        <option value="">Tidak ada peran kustom</option>
                    </select>
                </div>
            </div>

            <!-- Status Toggles -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="flex items-center">
                    <input type="checkbox" id="edit-is-active" class="rounded border-amber-300 text-green-500 focus:ring-green-300" aria-label="Status aktif pengguna">
                    <label for="edit-is-active" class="ml-2 text-amber-700">Aktif</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="edit-verified" class="rounded border-amber-300 text-purple-500 focus:ring-purple-300" aria-label="Status verifikasi pengguna">
                    <label for="edit-verified" class="ml-2 text-amber-700">Terverifikasi</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="edit-is-suspended" class="rounded border-amber-300 text-red-500 focus:ring-red-300" aria-label="Status suspend pengguna">
                    <label for="edit-is-suspended" class="ml-2 text-amber-700">Tersuspend</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="edit-is-premium" class="rounded border-amber-300 text-yellow-500 focus:ring-yellow-300" aria-label="Status premium pengguna">
                    <label for="edit-is-premium" class="ml-2 text-amber-700">Premium</label>
                </div>
            </div>

            <!-- Suspension Details -->
            <div id="suspension-details" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="edit-suspension-reason" class="block text-amber-700 font-medium mb-2">Alasan Suspend</label>
                        <input type="text" id="edit-suspension-reason" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                    </div>
                    <div>
                        <label for="edit-suspension-until" class="block text-amber-700 font-medium mb-2">Suspend Sampai</label>
                        <input type="datetime-local" id="edit-suspension-until" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                    </div>
                </div>
            </div>

            <div class="flex space-x-4" role="group" aria-label="Tombol aksi">
                <button type="button" onclick="closeEditUserModal()" class="w-full bg-gradient-to-r from-amber-300 to-yellow-300 hover:from-amber-400 hover:to-yellow-400 text-amber-800 py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-400 transition-all duration-300 shadow-md" aria-label="Batal edit pengguna">Batal</button>
                <button type="submit" class="w-full bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-600 hover:to-yellow-600 text-white py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-300 transition-all duration-300 shadow-md" aria-label="Simpan perubahan pengguna">Simpan</button>
            </div>
        </form>
    </div>
</div>

<!-- Create Role Modal -->
<div id="create-role-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50" role="dialog" aria-labelledby="create-role-title" aria-modal="true">
    <div class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <h2 id="create-role-title" class="text-xl font-semibold mb-6 text-amber-800">Buat Peran Baru</h2>
        <form id="create-role-form" class="space-y-6" role="form" aria-label="Form buat peran">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="role-name" class="block text-amber-700 font-medium mb-2">Nama Peran</label>
                    <input type="text" id="role-name" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" required aria-required="true">
                </div>
                <div>
                    <label for="role-description" class="block text-amber-700 font-medium mb-2">Deskripsi</label>
                    <input type="text" id="role-description" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                </div>
            </div>

            <div>
                <label class="block text-amber-700 font-medium mb-2">Izin</label>
                <div id="permissions-list" class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto">
                    <!-- Permissions will be loaded here -->
                </div>
            </div>

            <div class="flex space-x-4" role="group" aria-label="Tombol aksi">
                <button type="button" onclick="closeCreateRoleModal()" class="w-full bg-gradient-to-r from-amber-300 to-yellow-300 hover:from-amber-400 hover:to-yellow-400 text-amber-800 py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-400 transition-all duration-300 shadow-md" aria-label="Batal buat peran">Batal</button>
                <button type="submit" class="w-full bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-600 hover:to-yellow-600 text-white py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-300 transition-all duration-300 shadow-md" aria-label="Buat peran">Buat Peran</button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Role Modal -->
<div id="edit-role-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50" role="dialog" aria-labelledby="edit-role-title" aria-modal="true">
    <div class="bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-200 p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <h2 id="edit-role-title" class="text-xl font-semibold mb-6 text-amber-800">Edit Peran</h2>
        <form id="edit-role-form" class="space-y-6" role="form" aria-label="Form edit peran">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="edit-role-name" class="block text-amber-700 font-medium mb-2">Nama Peran</label>
                    <input type="text" id="edit-role-name" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400" required aria-required="true">
                </div>
                <div>
                    <label for="edit-role-description" class="block text-amber-700 font-medium mb-2">Deskripsi</label>
                    <input type="text" id="edit-role-description" class="w-full bg-white border border-amber-300 text-amber-700 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400">
                </div>
            </div>

            <div class="flex items-center">
                <input type="checkbox" id="edit-role-active" class="rounded border-amber-300 text-amber-500 focus:ring-amber-300" checked>
                <label for="edit-role-active" class="ml-2 text-amber-700">Aktif</label>
            </div>

            <div>
                <label class="block text-amber-700 font-medium mb-2">Izin</label>
                <div id="edit-permissions-list" class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-60 overflow-y-auto">
                    <!-- Permissions will be loaded here -->
                </div>
            </div>

            <div class="flex space-x-4" role="group" aria-label="Tombol aksi">
                <button type="button" onclick="closeEditRoleModal()" class="w-full bg-gradient-to-r from-amber-300 to-yellow-300 hover:from-amber-400 hover:to-yellow-400 text-amber-800 py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-400 transition-all duration-300 shadow-md" aria-label="Batal edit peran">Batal</button>
                <button type="submit" class="w-full bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-600 hover:to-yellow-600 text-white py-3 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-amber-300 transition-all duration-300 shadow-md" aria-label="Simpan perubahan peran">Simpan</button>
            </div>
        </form>
    </div>
</div>

<!-- Delete User Confirmation Modal -->
<div id="delete-user-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50" role="dialog" aria-labelledby="delete-user-title" aria-modal="true">
    <div class="bg-gradient-to-br from-amber-50 to-yellow-50 p-6 rounded-lg shadow-xl w-full max-w-md border border-amber-200">
        <h3 id="delete-user-title" class="text-xl font-semibold text-red-600 mb-4">Hapus Pengguna</h3>
        <p class="mb-4 text-amber-700">Apakah Anda yakin ingin menghapus pengguna ini? Tindakan ini tidak dapat dibatalkan.</p>
        <div class="bg-gradient-to-r from-red-100 to-pink-100 border border-red-200 rounded-lg p-3 mb-4">
            <p class="text-sm text-red-600"><i class="fas fa-exclamation-triangle mr-1"></i> Tindakan ini tidak dapat dibatalkan!</p>
        </div>
        <div class="flex justify-end space-x-4" role="group" aria-label="Tombol konfirmasi hapus">
            <button id="cancel-delete-user-btn" onclick="closeDeleteUserModal()" class="bg-gradient-to-r from-amber-300 to-yellow-300 hover:from-amber-400 hover:to-yellow-400 text-amber-800 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-300 transition-all duration-300 shadow-md" aria-label="Batal hapus pengguna">Batal</button>
            <button id="confirm-delete-user-btn" onclick="confirmDeleteUser()" class="bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-300 transition-all duration-300 shadow-md" aria-label="Konfirmasi hapus pengguna">Hapus</button>
        </div>
    </div>
</div>

<!-- Delete Role Confirmation Modal -->
<div id="delete-role-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50" role="dialog" aria-labelledby="delete-role-title" aria-modal="true">
    <div class="bg-gradient-to-br from-amber-50 to-yellow-50 p-6 rounded-lg shadow-xl w-full max-w-md border border-amber-200">
        <h3 id="delete-role-title" class="text-xl font-semibold text-red-600 mb-4">Hapus Peran</h3>
        <p class="mb-4 text-amber-700">Apakah Anda yakin ingin menghapus peran ini? Tindakan ini tidak dapat dibatalkan.</p>
        <div class="bg-gradient-to-r from-red-100 to-pink-100 border border-red-200 rounded-lg p-3 mb-4">
            <p class="text-sm text-red-600"><i class="fas fa-exclamation-triangle mr-1"></i> Tindakan ini tidak dapat dibatalkan!</p>
        </div>
        <div class="flex justify-end space-x-4" role="group" aria-label="Tombol konfirmasi hapus">
            <button id="cancel-delete-role-btn" onclick="closeDeleteRoleModal()" class="bg-gradient-to-r from-amber-300 to-yellow-300 hover:from-amber-400 hover:to-yellow-400 text-amber-800 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-300 transition-all duration-300 shadow-md" aria-label="Batal hapus peran">Batal</button>
            <button id="confirm-delete-role-btn" onclick="confirmDeleteRole()" class="bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-300 transition-all duration-300 shadow-md" aria-label="Konfirmasi hapus peran">Hapus</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/toast.js') }}"></script>
<script>
// Current user data - pass to JavaScript
window.currentUserData = {
    id: JSON.parse('{{ current_user.id | tojson | safe }}'),
    username: JSON.parse('{{ current_user.username | tojson | safe }}'),
    role: JSON.parse('{{ current_user.role.value | tojson | safe }}')
};
</script>
<script src="{{ url_for('static', filename='js/users-management.js') }}"></script>
{% endblock %}