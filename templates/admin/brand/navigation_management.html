{% extends "admin_base.html" %}
{% block title %}Navigation Management{% endblock %}
{% block hero_title %}Navigation Management{% endblock %}
{% block hero_desc %}Kelola link navigasi untuk navbar dan footer{% endblock %}

{% block content %}
<div class="space-y-8">
  <!-- Breadcrumb -->
  <div class="flex items-center gap-2 text-sm text-gray-600 mb-6">
    <a href="{{ url_for('main.settings_brand_identity') }}" class="hover:text-blue-600 transition-colors">
      Brand Management
    </a>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
    </svg>
    <span class="text-gray-800 font-medium">Navigation Management</span>
  </div>

  <!-- Navigation Management Section -->
  <div class="bg-white border border-gray-200 rounded-lg shadow-lg p-6" role="region" aria-label="Navigation Management">
    <div class="flex items-center gap-3 mb-6">
      <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 text-blue-600">
          <path stroke-linecap="round" stroke-linejoin="round" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
        </svg>
      </div>
      <h2 class="text-2xl font-bold text-gray-800">Navigation Management</h2>
    </div>

    <!-- Action Buttons Row -->
    <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
      <!-- Left side: Add and Copy buttons -->
      <div class="flex items-center gap-3">
        <button id="add-link-btn" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-all duration-300 shadow-md">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
          </svg>
          Add New Link
        </button>
        
        <button id="copy-links-btn" class="flex items-center gap-2 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg font-medium transition-all duration-300 shadow-md">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
          </svg>
          Copy Links
        </button>
      </div>

      <!-- Right side: Bulk actions -->
      <div id="bulk-actions" class="flex items-center gap-3 hidden" style="display: none;">
        <span id="selected-count" class="text-sm text-gray-700 font-medium">0 selected</span>
        
        <button id="bulk-activate-btn" class="flex items-center gap-2 bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Activate
        </button>
        
        <button id="bulk-deactivate-btn" class="flex items-center gap-2 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
          </svg>
          Deactivate
        </button>
        
        <button id="bulk-delete-btn" class="flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
          Delete
        </button>
        
        <button id="bulk-clear-btn" class="text-gray-700 hover:text-gray-900 py-2 px-3 rounded-lg text-sm font-medium transition-all duration-300">
          Clear
        </button>
      </div>
    </div>

    <!-- Navigation Links Tabs -->
    <div class="mb-6">
      <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8">
          <button id="navbar-tab" class="nav-tab active px-4 py-2 text-blue-600 border-b-2 border-blue-500 font-medium transition-all duration-300" data-location="navbar">
            Navbar Links
          </button>
          <button id="footer-tab" class="nav-tab px-4 py-2 text-gray-500 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 font-medium transition-all duration-300" data-location="footer">
            Footer Quick Links
          </button>
        </nav>
      </div>
    </div>

    <!-- Links Container -->
    <div id="links-container" class="space-y-4">
      <!-- Links will be loaded here -->
    </div>

    <!-- Loading State -->
    <div id="loading" class="text-center py-8 hidden">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
      <p class="text-gray-700 mt-2">Memuat link navigasi...</p>
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="text-center py-12 hidden">
      <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
      </svg>
      <h3 class="text-lg font-semibold text-gray-800 mb-2">No navigation links yet</h3>
      <p class="text-gray-600 mb-4">Add your first link to start managing navigation</p>
      <button id="add-first-link-btn" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-all duration-300 shadow-md">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
        </svg>
        Add First Link
      </button>
    </div>
  </div>
</div>

<!-- Add/Edit Link Modal -->
<div id="link-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white border border-gray-200 rounded-xl shadow-2xl max-w-md w-full">
      <div class="p-6">
        <h3 id="modal-title" class="text-lg font-semibold text-gray-800 mb-4">
          Add New Link
        </h3>
        
        <form id="link-form" class="space-y-4">
          <input type="hidden" id="link-id" name="id">
          
          <div>
            <label for="link-name" class="block text-sm font-medium text-gray-800 mb-2">
              Link Name *
            </label>
            <input type="text" id="link-name" name="name" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          
          <div>
            <label for="link-url" class="block text-sm font-medium text-gray-800 mb-2">
              URL *
            </label>
            <input type="url" id="link-url" name="url" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                   placeholder="https://example.com or /news">
          </div>
          
          <!-- Internal Links Dropdown -->
          <div id="internal-link-container" class="mb-4 hidden">
            <label for="internal-link-select" class="block text-sm font-medium text-gray-800 mb-2">
              Select Internal Link
            </label>
            <select id="internal-link-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">-- Select Page --</option>
              {% for link in internal_links %}
                <option value="{{ link.url }}">{{ link.name }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div>
            <label for="link-location" class="block text-sm font-medium text-gray-800 mb-2">
              Location *
            </label>
            <select id="link-location" name="location" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="navbar">Navbar</option>
              <option value="footer">Footer Quick Links</option>
            </select>
          </div>
          
          <div>
            <label for="link-order" class="block text-sm font-medium text-gray-800 mb-2">
              Order
            </label>
            <input type="number" id="link-order" name="order" min="0" value="0"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          
          <div class="flex items-center space-x-4">
            <label class="flex items-center">
              <input type="checkbox" id="link-active" name="is_active" checked
                     class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              <span class="ml-2 text-sm text-gray-800">Active</span>
            </label>
            
            <label class="flex items-center">
              <input type="checkbox" id="link-external" name="is_external"
                     class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              <span class="ml-2 text-sm text-gray-800">External Link</span>
            </label>
          </div>
        </form>
        
        <div class="flex justify-end space-x-3 mt-6">
          <button id="cancel-btn" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300">
            Cancel
          </button>
          <button id="save-btn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-300 shadow-md">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Copy Links Modal -->
<div id="copy-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white border border-gray-200 rounded-xl shadow-2xl max-w-lg w-full">
      <div class="p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Copy Navigation Links</h3>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-800 mb-2">Copy From:</label>
            <select id="copy-from" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">-- Select Source --</option>
              <option value="navbar">Navbar Links</option>
              <option value="footer">Footer Quick Links</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-800 mb-2">Copy To:</label>
            <select id="copy-to" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">-- Select Destination --</option>
              <option value="navbar">Navbar Links</option>
              <option value="footer">Footer Quick Links</option>
            </select>
          </div>
          
          <div class="flex items-center space-x-4">
            <label class="flex items-center">
              <input type="checkbox" id="copy-overwrite" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
              <span class="ml-2 text-sm text-gray-800">Overwrite existing links</span>
            </label>
          </div>
          
                      <div id="copy-preview" class="hidden">
              <label class="block text-sm font-medium text-gray-800 mb-2">Preview:</label>
              <div id="copy-preview-content" class="max-h-40 overflow-y-auto bg-white border border-gray-200 rounded-lg p-3 text-sm text-gray-700">
                <!-- Preview content will be loaded here -->
              </div>
            </div>
        </div>
        
        <div class="flex justify-end space-x-3 mt-6">
          <button id="cancel-copy-btn" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300">
            Cancel
          </button>
          <button id="confirm-copy-btn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-300 shadow-md">
            Copy Links
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white border border-gray-200 rounded-xl shadow-2xl max-w-md w-full">
      <div class="p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Confirm Delete</h3>
        <p class="text-gray-700 mb-6">Are you sure you want to delete this link? This action cannot be undone.</p>
        
                  <div class="flex justify-end space-x-3">
            <button id="cancel-delete-btn" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300">
              Cancel
            </button>
            <button id="confirm-delete-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-300 shadow-md">
              Delete
            </button>
          </div>
      </div>
    </div>
  </div>
</div>

<!-- Bulk Delete Confirmation Modal -->
<div id="bulk-delete-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white border border-gray-200 rounded-xl shadow-2xl max-w-md w-full">
      <div class="p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Confirm Bulk Delete</h3>
        <p class="text-gray-700 mb-6">Are you sure you want to delete <span id="bulk-delete-count">0</span> selected links? This action cannot be undone.</p>
        
                  <div class="flex justify-end space-x-3">
            <button id="cancel-bulk-delete-btn" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300">
              Cancel
            </button>
            <button id="confirm-bulk-delete-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-300 shadow-md">
              Delete All
            </button>
          </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/toast.js') }}"></script>
<script src="{{ url_for('static', filename='js/navigation-management.js') }}"></script>
<script>
// Handle flash messages
document.addEventListener('DOMContentLoaded', () => {
    const messages = JSON.parse('{{ get_flashed_messages(with_categories=true) | tojson | safe }}');
    messages.forEach(([category, message]) => showToast(category, message));
});
</script>
{% endblock %} 