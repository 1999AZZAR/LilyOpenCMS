{% extends 'base.html' %}

{% block title %}Cerita - {{ user.get_full_name() or user.username }}{% endblock %}

{% block content %}
<div class="min-h-screen bg-background">
    <!-- Header -->
    <div class="bg-card border-b border-border">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-foreground">Cerita</h1>
                    <p class="mt-2 text-muted-foreground">Cerita {{ user.get_full_name() or user.username }}</p>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="{{ url_for('user_profile.user_profile', username=user.username) }}" 
                       class="text-primary hover:text-foreground">
                        <i class="fas fa-arrow-left mr-2"></i>Kembali ke Profil
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Status Tabs and Create Button -->
        <div class="flex items-center justify-between border-b border-border mb-6">
            <nav class="flex space-x-8" aria-label="Story status tabs">
                <button id="published-tab" 
                        class="py-2 px-1 border-b-2 font-medium text-sm border-primary text-primary">
                    Dipublikasikan ({{ published_stories|length }})
                </button>
                <button id="draft-tab" 
                        class="py-2 px-1 border-b-2 font-medium text-sm border-transparent text-muted-foreground hover:text-foreground hover:border-border">
                    Draf ({{ draft_stories|length }})
                </button>
            </nav>
            
            {% if current_user.is_authenticated and current_user.id == user.id and has_write_access(user) %}
                <div class="flex items-center space-x-3">
                    <a href="{{ url_for('user_profile.upload_docx_story', username=user.username) }}" 
                       class="text-blue-600 hover:text-blue-700 text-sm">
                        <i class="fas fa-file-word mr-2"></i>Upload DOCX
                    </a>
                    <a href="{{ url_for('user_profile.create_user_story', username=user.username) }}" 
                       class="text-primary hover:text-foreground text-sm">
                        <i class="fas fa-plus mr-2"></i>Tulis Cerita
                    </a>
                </div>
            {% endif %}
        </div>

        <!-- Published Stories -->
        <div id="published-content" class="space-y-6">
            {% if published_stories %}
                <div class="space-y-6">
                    {% for story in published_stories %}
                        <article class="bg-card rounded-lg shadow-sm border border-border overflow-hidden transition-all duration-300 hover:border-primary/30 hover:shadow-lg group">
                            <div class="flex flex-col sm:flex-row">
                                <!-- Image Container -->
                                <div class="sm:w-1/4 lg:w-1/3 xl:w-1/4 flex-shrink-0 bg-secondary overflow-hidden aspect-video sm:aspect-auto">
                                    <a href="{{ url_for('main.news_detail', news_id=story.id, news_title='story') }}" class="block h-full" aria-label="Read story: {{ story.title | e }}">
                                        {% if story.image_id %}
                                            <img src="{{ url_for('static', filename='uploads/' + story.image.filename) }}" 
                                                 alt="{{ story.title }}" 
                                                 class="w-full h-full object-cover object-center transition-transform duration-300 ease-in-out group-hover:scale-105" 
                                                 loading="lazy">
                                        {% else %}
                                            <div class="w-full h-full bg-muted flex items-center justify-center">
                                                <i class="fas fa-newspaper text-4xl text-muted-foreground"></i>
                                            </div>
                                        {% endif %}
                                    </a>
                                </div>
                                <!-- Text Content Container -->
                                <div class="p-5 sm:p-6 flex flex-col justify-between flex-grow">
                                    <div>
                                        <!-- Title and Optional Premium Badge -->
                                        <div class="flex justify-between items-start mb-2 gap-x-2">
                                            <h3 class="text-lg font-semibold text-card-foreground leading-snug group-hover:text-primary transition-colors line-clamp-2">
                                                <a href="{{ url_for('main.news_detail', news_id=story.id, news_title='story') }}">{{ story.title }}</a>
                                            </h3>
                                            <div class="flex gap-1 mt-0.5 flex-shrink-0">
                                                {% if story.deletion_requested %}
                                                    <span class="bg-gray-100 text-gray-800 px-2 py-0.5 rounded text-xs font-semibold">
                                                        <i class="fas fa-archive mr-1"></i>Archived
                                                    </span>
                                                {% else %}
                                                    {% if story.is_news %}
                                                        <span class="bg-primary text-primary-foreground px-2 py-0.5 rounded text-xs font-semibold">Berita</span>
                                                    {% else %}
                                                        <span class="bg-secondary text-secondary-foreground px-2 py-0.5 rounded text-xs font-semibold">Artikel</span>
                                                    {% endif %}
                                                {% endif %}
                                                {% if story.is_premium %}
                                                    <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs font-semibold">Premium</span>
                                                {% endif %}
                                                {% if story.age_rating %}
                                                    <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded text-xs font-semibold">{{ story.age_rating }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <!-- Category Link -->
                                        {% if story.category %}
                                            <a href="{{ url_for('main.search', category=story.category.name) }}" class="text-xs font-medium text-primary mb-3 inline-block uppercase tracking-wider hover:underline">
                                                {{ story.category.name }}
                                            </a>
                                        {% endif %}
                                        <!-- Story Excerpt (truncated) -->
                                        <p class="text-sm text-muted-foreground mb-4 line-clamp-3">{{ story.content | striptags | truncate(140) }}</p>
                                    </div>
                                                                            <!-- Meta Footer: Author, Date, Read Count -->
                                        <div class="mt-4 pt-3 border-t border-border text-xs text-muted-foreground flex flex-wrap items-center gap-x-3 gap-y-1">
                                            <span class="flex items-center gap-x-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.154a6.471 6.471 0 0 0-1.655-1.889A6.551 6.551 0 0 0 8 10c-1.83 0-3.53.772-4.743 2.036A6.47 6.47 0 0 0 1.6 12.846C1.38 13.439 1.855 14 2.473 14h10.262Z" /></svg>
                                                {{ story.writer if story.writer else story.author.username if story.author else 'Anonim' }}
                                            </span>
                                            {% if story.date %}
                                            <span class="flex items-center gap-x-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path fill-rule="evenodd" d="M4 1.75a.75.75 0 0 1 .75.75V3h6.5V2.5a.75.75 0 0 1 1.5 0V3h.5A1.75 1.75 0 0 1 15 4.75v8.5A1.75 1.75 0 0 1 13.25 15H2.75A1.75 1.75 0 0 1 1 13.25v-8.5A1.75 1.75 0 0 1 2.75 3H3.5V2.5a.75.75 0 0 1 4 1.75ZM2.5 7.75v5.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-5.5H2.5Zm11-3H2.5V4.75c0-.138.112-.25.25-.25h10.5a.25.25 0 0 1 .25.25V5Z" clip-rule="evenodd" /></svg>
                                                {{ story.date.strftime('%d %b %Y') }}
                                            </span>
                                            {% endif %}
                                            <span class="flex items-center gap-x-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" /><path fill-rule="evenodd" d="M1.38 8.28a.87.87 0 0 1 0-.56C2.415 6.11 4.96 4 8 4s5.585 2.11 6.62 3.72a.87.87 0 0 1 0 .56C13.585 9.89 11.04 12 8 12s-5.585-2.11-6.62-3.72ZM8 10.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" clip-rule="evenodd" /></svg>
                                                {{ story.read_count | default(0) }} dibaca
                                            </span>
                                        {% if story.rating and story.rating.has_ratings %}
                                        <span class="flex items-center gap-x-1 text-yellow-600">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path d="M8 1.75l1.5 3.5L13.5 5.5l-2.5 2.5.5 3.5L8 12.5l-3.5 1.5.5-3.5L2.5 5.5l3.5-.25L8 1.75z" /></svg>
                                            {{ story.rating.average|round(1) }}
                                        </span>
                                        {% endif %}
                                    </div>
                                    
                                    {% if current_user.is_authenticated and current_user.id == user.id %}
                                        <div class="mt-3 flex space-x-2">
                                            {% if story.deletion_requested %}
                                                <button disabled class="flex-1 bg-gray-100 text-gray-400 text-center py-2 px-3 rounded text-sm cursor-not-allowed">
                                                    <i class="fas fa-edit mr-1"></i>Edit
                                                </button>
                                                <button disabled class="flex-1 bg-gray-100 text-gray-400 text-center py-2 px-3 rounded text-sm cursor-not-allowed">
                                                    <i class="fas fa-clock mr-1"></i>Permintaan Tertunda
                                                </button>
                                            {% else %}
                                                <a href="{{ url_for('user_profile.create_user_story', username=user.username, news_id=story.id) }}" 
                                                   class="flex-1 bg-secondary text-secondary-foreground text-center py-2 px-3 rounded text-sm hover:bg-secondary/90 transition-colors">
                                                    <i class="fas fa-edit mr-1"></i>Edit
                                                </a>
                                                <button onclick="requestStoryDeletion({{ story.id }}, '{{ story.title | e }}')" 
                                                        class="flex-1 bg-orange-100 hover:bg-orange-200 text-orange-600 text-center py-2 px-3 rounded text-sm transition-colors">
                                                    <i class="fas fa-trash mr-1"></i>Minta Hapus
                                                </button>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12">
                    <i class="fas fa-newspaper text-4xl text-muted-foreground mb-4"></i>
                    <h3 class="text-lg font-medium text-foreground mb-2">Tidak ada cerita yang dipublikasikan</h3>
                    <p class="text-muted-foreground mb-4">Pengguna ini belum memublikasikan cerita apapun.</p>
                    {% if current_user.is_authenticated and current_user.id == user.id %}
                        <div class="flex flex-col sm:flex-row gap-3 justify-center">
                            <a href="{{ url_for('user_profile.upload_docx_story', username=user.username) }}" 
                               class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                <i class="fas fa-file-word mr-2"></i>Upload Cerita DOCX
                            </a>
                            <a href="{{ url_for('user_profile.create_user_story', username=user.username) }}" 
                               class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                                <i class="fas fa-plus mr-2"></i>Tulis Cerita Pertama Anda
                            </a>
                        </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>

        <!-- Draft Stories -->
        <div id="draft-content" class="space-y-6 hidden">
            {% if draft_stories %}
                <div class="space-y-6">
                    {% for story in draft_stories %}
                        <article class="bg-card rounded-lg shadow-sm border border-border overflow-hidden transition-all duration-300 hover:border-primary/30 hover:shadow-lg group">
                            <div class="flex flex-col sm:flex-row">
                                <!-- Image Container -->
                                <div class="sm:w-1/3 lg:w-2/5 xl:w-1/3 flex-shrink-0 bg-secondary overflow-hidden aspect-video sm:aspect-auto">
                                    <div class="w-full h-full bg-muted flex items-center justify-center">
                                        {% if story.image_id %}
                                            <img src="{{ url_for('static', filename='uploads/' + story.image.filename) }}" 
                                                 alt="{{ story.title }}" 
                                                 class="w-full h-full object-cover object-center" 
                                                 loading="lazy">
                                        {% else %}
                                            <i class="fas fa-edit text-4xl text-muted-foreground"></i>
                                        {% endif %}
                                    </div>
                                </div>
                                <!-- Text Content Container -->
                                <div class="p-5 sm:p-6 flex flex-col justify-between flex-grow">
                                    <div>
                                        <!-- Title and Optional Premium Badge -->
                                        <div class="flex justify-between items-start mb-2 gap-x-2">
                                            <h3 class="text-lg font-semibold text-card-foreground leading-snug line-clamp-2">
                                                {{ story.title }}
                                            </h3>
                                            <div class="flex gap-1 mt-0.5 flex-shrink-0">
                                                {% if story.deletion_requested %}
                                                    <span class="bg-gray-100 text-gray-800 px-2 py-0.5 rounded text-xs font-semibold">
                                                        <i class="fas fa-archive mr-1"></i>Archived
                                                    </span>
                                                {% else %}
                                                    <span class="bg-muted text-foreground px-2 py-0.5 rounded text-xs font-semibold">Draf</span>
                                                {% endif %}
                                                {% if story.is_premium %}
                                                    <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs font-semibold">Premium</span>
                                                {% endif %}
                                                {% if story.age_rating %}
                                                    <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded text-xs font-semibold">{{ story.age_rating }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                        <!-- Category Link -->
                                        {% if story.category %}
                                            <span class="text-xs font-medium text-muted-foreground mb-3 inline-block uppercase tracking-wider">
                                                {{ story.category.name }}
                                            </span>
                                        {% endif %}
                                        <!-- Story Excerpt (truncated) -->
                                        <p class="text-sm text-muted-foreground mb-4 line-clamp-3">{{ story.content | striptags | truncate(140) }}</p>
                                    </div>
                                    <!-- Meta Footer: Author, Date, Draft Status -->
                                    <div class="mt-4 pt-3 border-t border-border text-xs text-muted-foreground flex flex-wrap items-center gap-x-3 gap-y-1">
                                        <span class="flex items-center gap-x-1">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.154a6.471 6.471 0 0 0-1.655-1.889A6.551 6.551 0 0 0 8 10c-1.83 0-3.53.772-4.743 2.036A6.47 6.47 0 0 0 1.6 12.846C1.38 13.439 1.855 14 2.473 14h10.262Z" /></svg>
                                            {{ story.writer if story.writer else story.author.username if story.author else 'Anonim' }}
                                        </span>
                                        {% if story.date %}
                                        <span class="flex items-center gap-x-1">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3.5 h-3.5"><path fill-rule="evenodd" d="M4 1.75a.75.75 0 0 1 .75.75V3h6.5V2.5a.75.75 0 0 1 1.5 0V3h.5A1.75 1.75 0 0 1 15 4.75v8.5A1.75 1.75 0 0 1 13.25 15H2.75A1.75 1.75 0 0 1 1 13.25v-8.5A1.75 1.75 0 0 1 2.75 3H3.5V2.5a.75.75 0 0 1 4 1.75ZM2.5 7.75v5.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-5.5H2.5Zm11-3H2.5V4.75c0-.138.112-.25.25-.25h10.5a.25.25 0 0 1 .25.25V5Z" clip-rule="evenodd" /></svg>
                                            {{ story.date.strftime('%d %b %Y') }}
                                        </span>
                                        {% endif %}
                                        <span class="flex items-center gap-x-1">
                                            <i class="fas fa-edit w-3.5 h-3.5"></i>
                                            Draft
                                        </span>
                                    </div>
                                    
                                    {% if current_user.is_authenticated and current_user.id == user.id %}
                                        <div class="mt-3 flex space-x-2">
                                            {% if story.deletion_requested %}
                                                <button disabled class="flex-1 bg-gray-100 text-gray-400 text-center py-2 px-3 rounded text-sm cursor-not-allowed">
                                                    <i class="fas fa-edit mr-1"></i>Edit
                                                </button>
                                                <button disabled class="flex-1 bg-gray-100 text-gray-400 text-center py-2 px-3 rounded text-sm cursor-not-allowed">
                                                    <i class="fas fa-clock mr-1"></i>Permintaan Tertunda
                                                </button>
                                            {% else %}
                                                <a href="{{ url_for('user_profile.create_user_story', username=user.username, news_id=story.id) }}" 
                                                   class="flex-1 bg-primary text-primary-foreground text-center py-2 px-3 rounded text-sm hover:bg-primary/90 transition-colors">
                                                    <i class="fas fa-edit mr-1"></i>Edit
                                                </a>
                                                <button onclick="requestStoryDeletion({{ story.id }}, '{{ story.title | e }}')" 
                                                        class="flex-1 bg-orange-100 hover:bg-orange-200 text-orange-600 text-center py-2 px-3 rounded text-sm transition-colors">
                                                    <i class="fas fa-trash mr-1"></i>Minta Hapus
                                                </button>
                                            {% endif %}
                                        </div>
                                    {% else %}
                                        <div class="mt-3">
                                            <span class="flex-1 text-center py-2 px-3 rounded text-sm bg-muted text-muted-foreground block">
                                                {% if story.deletion_requested %}Archived{% else %}Draf{% endif %}
                                            </span>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12">
                    <i class="fas fa-edit text-4xl text-muted-foreground mb-4"></i>
                    <h3 class="text-lg font-medium text-foreground mb-2">Tidak ada cerita draf</h3>
                    <p class="text-muted-foreground mb-4">Pengguna ini tidak memiliki cerita draf apapun.</p>
                    {% if current_user.is_authenticated and current_user.id == user.id %}
                        <div class="flex flex-col sm:flex-row gap-3 justify-center">
                            <a href="{{ url_for('user_profile.upload_docx_story', username=user.username) }}" 
                               class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                <i class="fas fa-file-word mr-2"></i>Upload Cerita DOCX
                            </a>
                            <a href="{{ url_for('user_profile.create_user_story', username=user.username) }}" 
                               class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                                <i class="fas fa-plus mr-2"></i>Mulai Menulis
                            </a>
                        </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-confirm-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50" role="dialog" aria-labelledby="delete-confirm-title" aria-modal="true">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
        <div class="p-6">
            <h3 id="delete-confirm-title" class="text-lg font-semibold text-gray-900 mb-4">Minta Penghapusan Cerita</h3>
            <p class="text-gray-700 mb-6">Apakah Anda yakin ingin meminta penghapusan "<span id="delete-story-title" class="font-semibold"></span>"?</p>
            <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4">
                <p class="text-sm text-orange-600"><i class="fas fa-info-circle mr-1"></i> Ini akan mengirimkan permintaan penghapusan untuk ditinjau oleh admin.</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button onclick="closeDeleteConfirmModal()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors">
                    Batal
                </button>
                <button id="confirm-delete-btn" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    Minta Penghapusan
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const publishedTab = document.getElementById('published-tab');
    const draftTab = document.getElementById('draft-tab');
    const publishedContent = document.getElementById('published-content');
    const draftContent = document.getElementById('draft-content');

    // Tab switching functionality
    publishedTab.addEventListener('click', function() {
        publishedTab.classList.add('border-primary', 'text-primary');
        publishedTab.classList.remove('border-transparent', 'text-muted-foreground');
        draftTab.classList.remove('border-primary', 'text-primary');
        draftTab.classList.add('border-transparent', 'text-muted-foreground');
        
        publishedContent.classList.remove('hidden');
        draftContent.classList.add('hidden');
    });

    draftTab.addEventListener('click', function() {
        draftTab.classList.add('border-primary', 'text-primary');
        draftTab.classList.remove('border-transparent', 'text-muted-foreground');
        publishedTab.classList.remove('border-primary', 'text-primary');
        publishedTab.classList.add('border-transparent', 'text-muted-foreground');
        
        draftContent.classList.remove('hidden');
        publishedContent.classList.add('hidden');
    });

    // Add escape key listener to close delete modal
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeDeleteConfirmModal();
        }
    });
    
    // Add click outside to close delete modal
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('fixed') && e.target.classList.contains('bg-black')) {
            closeDeleteConfirmModal();
        }
    });
});

// Global variables for delete functionality
let storyToDelete = null;

// Request story deletion - shows confirmation modal
function requestStoryDeletion(storyId, storyTitle) {
    storyToDelete = storyId;
    document.getElementById('delete-story-title').textContent = storyTitle;
    document.getElementById('delete-confirm-modal').classList.remove('hidden');
    
    // Set up the confirm button
    const confirmBtn = document.getElementById('confirm-delete-btn');
    confirmBtn.onclick = function() {
        deleteStory(storyId);
    };
}

// Close delete confirmation modal
function closeDeleteConfirmModal() {
    document.getElementById('delete-confirm-modal').classList.add('hidden');
    storyToDelete = null;
}

// Delete story function - uses deletion request system
async function deleteStory(storyId) {
    try {
        const response = await fetch(`/api/news/${storyId}/request-deletion`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });

        if (!response.ok) {
            const contentType = response.headers.get('content-type');
            if (contentType && contentType.includes('application/json')) {
                const errorData = await response.json();
                throw new Error(errorData.error || 'Failed to request story deletion');
            } else {
                throw new Error('Session expired. Please refresh the page and try again.');
            }
        }

        // Show success message
        showToast('Permintaan penghapusan cerita berhasil dikirim! Admin akan meninjau permintaan Anda.', 'success');
        closeDeleteConfirmModal();
        
        // Reload the page to refresh the story list
        window.location.reload();
        
    } catch (error) {
        console.error('Error requesting story deletion:', error);
        showToast(`Gagal meminta penghapusan cerita: ${error.message}`, 'error');
    }
}

// Simple toast notification function
function showToast(message, type = 'info') {
    // Remove existing toasts
    const existingToasts = document.querySelectorAll('.toast-notification');
    existingToasts.forEach(toast => toast.remove());
    
    const toast = document.createElement('div');
    toast.className = `toast-notification fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full`;
    
    let bgColor, textColor, icon;
    switch(type) {
        case 'success':
            bgColor = 'bg-green-500';
            textColor = 'text-white';
            icon = 'fas fa-check-circle';
            break;
        case 'error':
            bgColor = 'bg-red-500';
            textColor = 'text-white';
            icon = 'fas fa-exclamation-circle';
            break;
        case 'warning':
            bgColor = 'bg-yellow-500';
            textColor = 'text-white';
            icon = 'fas fa-exclamation-triangle';
            break;
        default:
            bgColor = 'bg-blue-500';
            textColor = 'text-white';
            icon = 'fas fa-info-circle';
    }
    
    toast.innerHTML = `
        <div class="flex items-center ${bgColor} ${textColor} p-3 rounded-lg">
            <i class="${icon} mr-3"></i>
            <span class="flex-1">${message}</span>
            <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-white hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
    `;
    
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.classList.remove('translate-x-full');
    }, 100);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        if (toast.parentElement) {
            toast.classList.add('translate-x-full');
            setTimeout(() => toast.remove(), 300);
        }
    }, 5000);
}
</script>
{% endblock %}